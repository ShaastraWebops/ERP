{% extends "finance/finance_base_portal.html" %}
{% block content %}
    <ul class="nav nav-pills">
    <li  >
    <a href="{% url finance.views.budget_portal plan='budget'%}"><i class="icon-th-list "></i>Budget</a>
    </li>
    <li>
    <a href="{% url finance.views.advance dept='0'  %}"><i class="icon-edit"></i>Advance Request</a>
    </li>
    <li class='active'>
    <a href="{% url finance.views.reimb %}"><i class="icon-ok-sign icon-white"></i>Reimbursement</a>
    </li>
    </ul>
    <div class="pull-right">
    <a class="btn btn-info" href={% url finance.views.reimb %}> &lt Back</a>
    </div>
    <hr>
{% if has_perms %}
{% if not open_reimb_portal.opened %}
<h6> All the events in white have Pending Approval.</h6>
    {% for dept in submitted_depts %}
{% if dept.Dept_Name in event_pending %}
{% ifequal dept event_department %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong>{{dept}}</strong></a>
    {% else %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
{% endifequal %}
{% else %}
{% ifequal dept event_department %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong style="font-size:15px;">{{dept}}</strong></a>
    {% else %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
    {% endifequal %}
{% endif %}
    {% endfor %}
    <hr>
    
    {% if not not_visit %}	
    
    <div class="well">
    {% if open_reimb_portal.opened %}
    <h4>The Reimbursement Portal is CURRENTLY OPENED for the Event Coordinators to submit their bills and to claim their Reimbursement</h4>
    </br>
    {% else %}
    <h4>The Reimbursement Portal is CURRENTLY CLOSED for the Event Coordinators</h4>
    </br>
    {% endif %}
    </div>
    <h4>Total Budget Sanctioned: {{plan_finance.total_amount}}</h4>
    
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#plan"><h4>View Event Budget </h4></a>
    </div>
    <div id="plan" class="accordian-body collapse">
    </br>
    <table class="table table-striped table-bordered table-condensed pull-left">
        <thead>
	    	<tr>
	    	<th>Items Name</th>
	    	<th>Description</th>
	    	<th>Quantity</th>
	    	<th>Amount</th>	
           	</tr>
        </thead>
        <tbody>
        {% for item in items %}	
            {% ifequal item.budget plan_finance %}
        		<tr>
	    		<td>{{item.name}}</td>
	    		<td>{{item.description}}</td>
	    		<td>{{item.quantity}}</td>
	    		<td>{{item.original_amount}}</td>
                </tr>
            {% endifequal %}			
        {% endfor %}
        </tbody>
    </table>	
    <h5>comments:</h5> <p>{{plan_finance.comment}}</p>    
    </div>
    
    </br>
    <h4>Total Amount Given so far: {{given_amount}}</h4>
    <h4>Balance Amount left: {{balance_amount}}</h4>
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#reimb_detail"><h4>View Event's Reimbursement Claim </h4></a>
    </div>
    <div id="reimb_detail" class="accordian-body collapse">
    </br>
    <table class="table table-condensed table-bordered">
    <thead>
    <th>Bill Number</th>
    <th>Details</th>
    <th>Vendor</th>
    <th>Amount</th>
    </thead>
    <tbody>
    {% for bill in bills %}
    <tr>
    <td>{{bill.number}}</td>
    <td>{{bill.detail}}</td>
    <td>{{bill.vendor}}</td>
    <td>{{bill.amount}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div></br>
    {% if error %}
        <div class="alert">
        <button type="button" class="close" data-dismiss="alert">×</button>
	    <strong>Error</strong>
	    Please Check the inputs    
	    </div>
    {% endif %}
    
    {% if form_saved %}
        <div class="alert alert-success">
        <button type="button" class="close" data-dismiss="alert">×</button>
	    Saved Successfully    
	    </div>
    {% endif %}
    </br>
    <h4>Total Amount to be Reimbursed: {{reimb_instance.amount}}</h4>
    </br>
    <form action='' method='POST'>
    {% csrf_token %}
    <table>
    {{reimbform1}}
    </table>
    <div class="pull-left">
    <input type="submit" value="Comment" class="btn btn-primary"/>
    </div>
    </form>
    {% else %}
    <h4>{{event_department}} have not visited the reimbursement portal.</h4>
    {% endif %}
    
{% endif %}

{% if open_reimb_portal.opened %}


<h6> All the events in white have Pending Approval.</h6>
    {% for dept in submitted_depts %}
{% if dept.Dept_Name in event_pending %}
{% ifequal dept event_department %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong>{{dept}}</strong></a>
    {% else %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
{% endifequal %}
{% else %}
{% ifequal dept event_department %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong style="font-size:15px;">{{dept}}</strong></a>
    {% else %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
    {% endifequal %}
{% endif %}
    {% endfor %}

{% if not not_visit %}	

    <div class="well">
    {% if open_reimb_portal.opened %}
    <h4>The Reimbursement Portal is CURRENTLY OPENED for the Event Coordinators to submit their bills and to claim their Reimbursement</h4>
    </br>
    {% else %}
    <h4>The Reimbursement Portal is CURRENTLY CLOSED for the Event Coordinators</h4>
    </br>
    {% endif %}
    </div>
    <h4>Total Budget Sanctioned: {{plan_finance.total_amount}}</h4>
    
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#plan"><h4>View Event Budget </h4></a>
    </div>
    <div id="plan" class="accordian-body collapse">
    </br>
    <table class="table table-striped table-bordered table-condensed pull-left">
        <thead>
	    	<tr>
	    	<th>Items Name</th>
	    	<th>Description</th>
	    	<th>Quantity</th>
	    	<th>Amount</th>	
           	</tr>
        </thead>
        <tbody>
        {% for item in items %}	
            {% ifequal item.budget plan_finance %}
        		<tr>
	    		<td>{{item.name}}</td>
	    		<td>{{item.description}}</td>
	    		<td>{{item.quantity}}</td>
	    		<td>{{item.original_amount}}</td>
                </tr>
            {% endifequal %}			
        {% endfor %}
        </tbody>
    </table>	
    <h5>comments:</h5> <p>{{plan_finance.comment}}</p>    
    </div>
    
    </br>
    <h4>Total Amount Given so far: {{given_amount}}</h4>
    <h4>Balance Amount left: {{balance_amount}}</h4></br>
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#reimb_detail"><h4>View Event's Reimbursement Claim </h4></a>
    </div>
    <div id="reimb_detail" class="accordian-body collapse">
    </br>
    <table class="table table-condensed table-bordered">
    <thead>
    <th>Bill Number</th>
    <th>Details</th>
    <th>Vendor</th>
    <th>Amount</th>
    </thead>
    <tbody>
    {% for bill in bills %}
    <tr>
    <td>{{bill.number}}</td>
    <td>{{bill.detail}}</td>
    <td>{{bill.vendor}}</td>
    <td>{{bill.amount}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div>
    </br>
    <h4>Total Amount to be Reimbursed: {{reimb_instance.amount}}</h4></br>
    <b style="font-size:14px;">Status:</b>
    {% if reimb_instance.status == "Y" %}
	<td><span class="label label-success" style="font-size:14px;">Paid</span></td>
	{% endif %}
	{% if reimb_instance.status == "N" %}
	<td><span class="label label-important" style="font-size:14px;" >Pending Approval</span></td>
	{% endif %}
	</br>
    <b style="font-size:14px;">Finance Department's Comment: </b>{{reimb_instance.comment}}

    {% else %}
    <h4>{{event_department}} have not visited the reimbursement portal.</h4>
    {% endif %}
    
{% endif %}
{% endif %}

{% if finance %}
{% if not has_perms %}

   <h6> All the events in white have Pending Approval.</h6>
    {% for dept in submitted_depts %}
{% if dept.Dept_Name in event_pending %}
{% ifequal dept event_department %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong>{{dept}}</strong></a>
    {% else %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
{% endifequal %}
{% else %}
{% ifequal dept event_department %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong style="font-size:15px;">{{dept}}</strong></a>
    {% else %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
    {% endifequal %}
{% endif %}
    {% endfor %}

    <hr>
    {% if not not_visit %}
    
    <div class="well">
    {% if open_reimb_portal.opened %}
    <h4>The Reimbursement Portal is CURRENTLY OPENED for the Event Coordinators to submit their bills and to claim their Reimbursement</h4>
    </br>
    {% else %}
    <h4>The Reimbursement Portal is CURRENTLY CLOSED for the Event Coordinators</h4>
    </br>
    {% endif %}
    </div>
    
    <h4>Total Budget Sanctioned: {{plan_finance.total_amount}}</h4>
    
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#plan"><h4>View Event Budget </h4></a>
    </div>
    <div id="plan" class="accordian-body collapse">
    </br>
    <table class="table table-striped table-bordered table-condensed pull-left">
        <thead>
	    	<tr>
	    	<th>Items Name</th>
	    	<th>Description</th>
	    	<th>Quantity</th>
	    	<th>Amount</th>	
           	</tr>
        </thead>
        <tbody>
        {% for item in items %}	
            {% ifequal item.budget plan_finance %}
        		<tr>
	    		<td>{{item.name}}</td>
	    		<td>{{item.description}}</td>
	    		<td>{{item.quantity}}</td>
	    		<td>{{item.original_amount}}</td>
                </tr>
            {% endifequal %}			
        {% endfor %}
        </tbody>
    </table>	
    <h5>comments:</h5> <p>{{plan_finance.comment}}</p>    
    </div>
    
    </br>
    <h4>Total Amount Given so far: {{given_amount}}</h4>
    <h4>Balance Amount left: {{balance_amount}}</h4></br>
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#reimb_detail"><h4>View Event's Reimbursement Claim </h4></a>
    </div>
    <div id="reimb_detail" class="accordian-body collapse">
    </br>
    <table class="table table-condensed table-bordered">
    <thead>
    <th>Bill Number</th>
    <th>Details</th>
    <th>Vendor</th>
    <th>Amount</th>
    </thead>
    <tbody>
    {% for bill in bills %}
    <tr>
    <td>{{bill.number}}</td>
    <td>{{bill.detail}}</td>
    <td>{{bill.vendor}}</td>
    <td>{{bill.amount}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div>
    </br>
    <h4>Total Amount to be Reimbursed: {{reimb_instance.amount}}</h4></br>
    <b style="font-size:14px;">Status:</b>
    {% if reimb_instance.status == "Y" %}
	<td><span class="label label-success" style="font-size:14px;">Paid</span></td>
	{% endif %}
	{% if reimb_instance.status == "N" %}
	<td><span class="label label-important" style="font-size:14px;" >Pending Approval</span></td>
	{% endif %}
	</br>
    <b style="font-size:14px;">Finance Department's Comment: </b>{{reimb_instance.comment}}
    
    {% else %}
    <h4>{{event_department}} have not visited the reimbursement portal.</h4>
    {% endif %}
{% endif %}
{% endif %}
    
{% if qms_dept %}
<h6> All the events in white have Pending Approval.</h6>
    {% for dept in submitted_depts %}
{% if dept.Dept_Name in event_pending %}
{% ifequal dept event_department %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong>{{dept}}</strong></a>
    {% else %}
    <a class="btn" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
{% endifequal %}
{% else %}
{% ifequal dept event_department %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}"><strong style="font-size:15px;">{{dept}}</strong></a>
    {% else %}
    <a class="btn btn-success" href="{% url finance.views.reimb_finance dept_id=dept.id %}">{{dept}}</a>
    {% endifequal %}
{% endif %}
    {% endfor %}

    <hr>
    
    <div class="well">
    {% if open_reimb_portal.opened %}
    <h4>The Reimbursement Portal is CURRENTLY OPENED for the Event Coordinators to submit their bills and to claim their Reimbursement</h4>
    </br>
    {% else %}
    <h4>The Reimbursement Portal is CURRENTLY CLOSED for the Event Coordinators</h4>
    </br>
    {% endif %}
    </div>
    
    {% if not not_visit %}
    <h4>Total Budget Sanctioned: {{plan_finance.total_amount}}</h4>
    
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#plan"><h4>View Event Budget </h4></a>
    </div>
    <div id="plan" class="accordian-body collapse">
    </br>
    <table class="table table-striped table-bordered table-condensed pull-left">
        <thead>
	    	<tr>
	    	<th>Items Name</th>
	    	<th>Description</th>
	    	<th>Quantity</th>
	    	<th>Amount</th>	
           	</tr>
        </thead>
        <tbody>
        {% for item in items %}	
            {% ifequal item.budget plan_finance %}
        		<tr>
	    		<td>{{item.name}}</td>
	    		<td>{{item.description}}</td>
	    		<td>{{item.quantity}}</td>
	    		<td>{{item.original_amount}}</td>
                </tr>
            {% endifequal %}			
        {% endfor %}
        </tbody>
    </table>	
    <h5>comments:</h5> <p>{{plan_finance.comment}}</p>    
    </div>
    
    </br>
    <h4>Total Amount Given so far: {{given_amount}}</h4>
    <h4>Balance Amount left: {{balance_amount}}</h4></br>
    <div class="accordian-heading pull-left">
    <a data-toggle="collapse" href="#reimb_detail"><h4>View Event's Reimbursement Claim </h4></a>
    </div>
    <div id="reimb_detail" class="accordian-body collapse">
    </br>
    <table class="table table-condensed table-bordered">
    <thead>
    <th>Bill Number</th>
    <th>Details</th>
    <th>Vendor</th>
    <th>Amount</th>
    </thead>
    <tbody>
    {% for bill in bills %}
    <tr>
    <td>{{bill.number}}</td>
    <td>{{bill.detail}}</td>
    <td>{{bill.vendor}}</td>
    <td>{{bill.amount}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div>
    </br>
    <h4>Total Amount to be Reimbursed: {{reimb_instance.amount}}</h4></br>
    <b style="font-size:14px;">Status:</b>
    {% if reimb_instance.status == "Y" %}
	<td><span class="label label-success">Paid</span></td>
	{% endif %}
	{% if reimb_instance.status == "N" %}
	<td><span class="label label-important">Pending Approval</span></td>
	{% endif %}
	</br>
	    <b style="font-size:14px;">Finance Department's Comment: </b>{{reimb_instance.comment}}
    {% else %}
    <h4>{{event_department}} have not visited the reimbursement portal.</h4>
    {% endif %}	    
	    
{% endif %}
{% endblock %}
