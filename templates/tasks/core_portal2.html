{% extends "tasks/portal_common.html" %}

{% block portal_stuff %}

<h1>Dashboard</h1>

<a href="{% url tasks.views.create_task %}"><h2>Create a New Task</h2></a>

<hr>

{% block timeline %}
<h2>Timeline for {{ user_dept_name }} Department</h2>
List of all Tasks in your Department
<table>
  <tr>
    <th>Subject</th>
    <th>Creator</th>
    <th>Deadline</th>
    <th>Status</th>
    <th>Comments</th>
  </tr>
  {% for task in all_Tasks %}
  <tr>
    <td><a href="{% url tasks.views.edit_task task.id %}">{{ task.subject }}</a></td>
    <td> {{ task.creator.get_profile.name }} </td>
    <td> {{ task.deadline }} </td>
    <td> {{ task.status }} </td>
    <td>  <a href="{% url tasks.views.handle_task_comments task.id %}">Comments</a> </td>
  </tr>
  {% endfor %}
</table>

{% endblock %}
<hr>

{% block received_requests %}
<h2> Requests from other Departments and Unassigned SubTasks</h2>
Assign these to your Coords.
<table>
  <tr>
    <th>Subject</th>
    <th>Proposer</th>
    <th>Deadline</th>
    <th>Status</th>
    <th>Comments</th>
  </tr>
  {% for subtask in all_unassigned_received_SubTasks %}
  <tr>
    <td> <a href="{% url tasks.views.display_subtask subtask.id %}">{{ subtask.subject }}</a> </td>
    <td> {{ subtask.creator.get_profile.name }} </td>
    <td> {{ subtask.deadline }} </td>
    <td> {{ subtask.status }} </td>
    <td>  <a href="{% url tasks.views.handle_subtask_comments subtask.id %}">Comments</a> </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
<hr>

{% block sent_requests %}
<h2> Requests sent to other Departments </h2>
SubTasks you've sent to other Departments
<table>
  <tr>
    <th>Task Subject</th>
    <th>SubTask Subject</th>
    <th>Deadline</th>
    <th>Status</th>
    <th>Comments</th>
  </tr>
  {% for subtask in all_requested_SubTasks %}
  <tr>
    <td> <a href="{% url tasks.views.edit_task subtask.task.id %}">{{ subtask.task.subject }}</a> </td>
    <td> <a href="{% url tasks.views.display_subtask subtask.id %}">{{ subtask.subject }}</a> </td>
    <td> {{ subtask.deadline }} </td>
    <td> {{ subtask.status }} </td>
    <td>  <a href="{% url tasks.views.handle_subtask_comments subtask.id %}">Comments</a> </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}

<hr>

{% block completed %}
<h2> Completed SubTasks</h2>
SubTasks completed by your Coords
<table>
  <tr>
    <th>Subject</th>
    <th>Finisher</th>
    <!-- <th>Deadline</th> -->
    <!-- <th>Status</th> -->
  </tr>
  {% for subtask in all_completed_SubTasks %}
  <tr>
    <td> {{ subtask.subject }} </td>
    <td>
      {% for coord in subtask.coords.all %}
      {{ coord.get_profile.name }} 
      {% endfor %}
    </td>
    <!-- <td> {{ subtask.status }} </td> -->
  </tr>
  {% endfor %}
</table>
{% endblock %}

<hr>

{% endblock %}

{% block update_stuff %}
{% include "tasks/updates.html" %}
{% endblock %}
